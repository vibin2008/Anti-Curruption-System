const state_list = {


  // ================= STATES (28) =================


  "Andhra Pradesh": [

    "Alluri Sitarama Raju","Anakapalli","Anantapur","Annamayya",

    "Bapatla","Chittoor","Dr B R Ambedkar Konaseema","East Godavari",

    "Eluru","Guntur","Kadapa","Kakinada","Krishna","Kurnool",

    "Nandyal","NTR","Palnadu","Parvathipuram Manyam","Prakasam",

    "Sri Sathya Sai","Srikakulam","Tirupati","Visakhapatnam",

    "Vizianagaram","West Godavari"

  ],


  "Arunachal Pradesh": [

    "Anjaw","Changlang","East Kameng","East Siang","Kamle",

    "Kra Daadi","Kurung Kumey","Lepa Rada","Lohit","Longding",

    "Lower Dibang Valley","Lower Siang","Lower Subansiri","Namsai",

    "Pakke Kessang","Papum Pare","Shi Yomi","Siang","Tawang",

    "Tirap","Upper Dibang Valley","Upper Siang","Upper Subansiri",

    "West Kameng","West Siang"

  ],


  "Assam": [

    "Baksa","Barpeta","Biswanath","Bongaigaon","Cachar","Charaideo",

    "Chirang","Darrang","Dhemaji","Dhubri","Dibrugarh","Dima Hasao",

    "Goalpara","Golaghat","Hailakandi","Hojai","Jorhat","Kamrup",

    "Kamrup Metropolitan","Karbi Anglong","Karimganj","Kokrajhar",

    "Lakhimpur","Majuli","Morigaon","Nagaon","Nalbari","Sivasagar",

    "Sonitpur","South Salmara-Mankachar","Tinsukia","Udalguri",

    "West Karbi Anglong"

  ],


  "Bihar": [

    "Araria","Arwal","Aurangabad","Banka","Begusarai","Bhagalpur",

    "Bhojpur","Buxar","Darbhanga","East Champaran","Gaya",

    "Gopalganj","Jamui","Jehanabad","Kaimur","Katihar","Khagaria",

    "Kishanganj","Lakhisarai","Madhepura","Madhubani","Munger",

    "Muzaffarpur","Nalanda","Nawada","Patna","Purnia","Rohtas",

    "Saharsa","Samastipur","Saran","Sheikhpura","Sheohar",

    "Sitamarhi","Siwan","Supaul","Vaishali","West Champaran"

  ],


  "Chhattisgarh": [

    "Balod","Baloda Bazar","Balrampur","Bastar","Bemetara","Bijapur",

    "Bilaspur","Dantewada","Dhamtari","Durg","Gariaband",

    "Gaurela-Pendra-Marwahi","Janjgir-Champa","Jashpur","Kabirdham",

    "Kanker","Kondagaon","Korba","Koriya","Mahasamund","Mungeli",

    "Narayanpur","Raigarh","Raipur","Rajnandgaon","Sukma",

    "Surajpur","Surguja"

  ],


  "Goa": ["North Goa","South Goa"],


  "Gujarat": [

    "Ahmedabad","Amreli","Anand","Aravalli","Banaskantha","Bharuch",

    "Bhavnagar","Botad","Chhota Udaipur","Dahod","Dang",

    "Devbhoomi Dwarka","Gandhinagar","Gir Somnath","Jamnagar",

    "Junagadh","Kheda","Kutch","Mahisagar","Mehsana","Morbi",

    "Narmada","Navsari","Panchmahal","Patan","Porbandar","Rajkot",

    "Sabarkantha","Surat","Surendranagar","Tapi","Vadodara","Valsad"

  ],


  "Haryana": [

    "Ambala","Bhiwani","Charkhi Dadri","Faridabad","Fatehabad",

    "Gurugram","Hisar","Jhajjar","Jind","Kaithal","Karnal",

    "Kurukshetra","Mahendragarh","Nuh","Palwal","Panchkula",

    "Panipat","Rewari","Rohtak","Sirsa","Sonipat","Yamunanagar"

  ],


  "Himachal Pradesh": [

    "Bilaspur","Chamba","Hamirpur","Kangra","Kinnaur","Kullu",

    "Lahaul and Spiti","Mandi","Shimla","Sirmaur","Solan","Una"

  ],


  "Jharkhand": [

    "Bokaro","Chatra","Deoghar","Dhanbad","Dumka","East Singhbhum",

    "Garhwa","Giridih","Godda","Gumla","Hazaribagh","Jamtara",

    "Khunti","Koderma","Latehar","Lohardaga","Pakur","Palamu",

    "Ramgarh","Ranchi","Sahebganj","Seraikela Kharsawan","Simdega",

    "West Singhbhum"

  ],


  "Karnataka": [

    "Bagalkot","Ballari","Belagavi","Bengaluru Rural",

    "Bengaluru Urban","Bidar","Chamarajanagar","Chikkaballapur",

    "Chikkamagaluru","Chitradurga","Dakshina Kannada","Davanagere",

    "Dharwad","Gadag","Hassan","Haveri","Kalaburagi","Kodagu",

    "Kolar","Koppal","Mandya","Mysuru","Raichur","Ramanagara",

    "Shivamogga","Tumakuru","Udupi","Uttara Kannada","Vijayapura",

    "Yadgir"

  ],


  "Kerala": [

    "Alappuzha","Ernakulam","Idukki","Kannur","Kasaragod","Kollam",

    "Kottayam","Kozhikode","Malappuram","Palakkad",

    "Pathanamthitta","Thiruvananthapuram","Thrissur","Wayanad"

  ],


  "Madhya Pradesh": [

    "Agar Malwa","Alirajpur","Anuppur","Ashoknagar","Balaghat",

    "Barwani","Betul","Bhind","Bhopal","Burhanpur","Chhatarpur",

    "Chhindwara","Damoh","Datia","Dewas","Dhar","Dindori","Guna",

    "Gwalior","Harda","Hoshangabad","Indore","Jabalpur","Jhabua",

    "Katni","Khandwa","Khargone","Mandla","Mandsaur","Morena",

    "Narsinghpur","Neemuch","Panna","Raisen","Rajgarh","Ratlam",

    "Rewa","Sagar","Satna","Sehore","Seoni","Shahdol","Shajapur",

    "Sheopur","Shivpuri","Sidhi","Singrauli","Tikamgarh","Ujjain",

    "Umaria","Vidisha"

  ],


  "Maharashtra": [

    "Ahmednagar","Akola","Amravati","Aurangabad","Beed","Bhandara",

    "Buldhana","Chandrapur","Dhule","Gadchiroli","Gondia",

    "Hingoli","Jalgaon","Jalna","Kolhapur","Latur","Mumbai City",

    "Mumbai Suburban","Nagpur","Nanded","Nandurbar","Nashik",

    "Osmanabad","Palghar","Parbhani","Pune","Raigad","Ratnagiri",

    "Sangli","Satara","Sindhudurg","Solapur","Thane","Wardha",

    "Washim","Yavatmal"

  ],


  "Manipur": [

    "Bishnupur","Chandel","Churachandpur","Imphal East",

    "Imphal West","Jiribam","Kakching","Kamjong","Kangpokpi",

    "Noney","Pherzawl","Senapati","Tamenglong","Tengnoupal",

    "Thoubal","Ukhrul"

  ],


  "Meghalaya": [

    "East Garo Hills","East Jaintia Hills","East Khasi Hills",

    "North Garo Hills","Ri Bhoi","South Garo Hills",

    "South West Garo Hills","South West Khasi Hills",

    "West Garo Hills","West Jaintia Hills","West Khasi Hills"

  ],


  "Mizoram": [

    "Aizawl","Champhai","Hnahthial","Khawzawl","Kolasib","Lawngtlai",

    "Lunglei","Mamit","Saiha","Saitual","Serchhip"

  ],


  "Nagaland": [

    "Chumoukedima","Dimapur","Kiphire","Kohima","Longleng",

    "Mokokchung","Mon","Niuland","Noklak","Peren","Phek",

    "Shamator","Tseminyu","Tuensang","Wokha","Zunheboto"

  ],


  "Odisha": [

    "Angul","Balangir","Balasore","Bargarh","Bhadrak","Boudh",

    "Cuttack","Deogarh","Dhenkanal","Gajapati","Ganjam",

    "Jagatsinghpur","Jajpur","Jharsuguda","Kalahandi","Kandhamal",

    "Kendrapara","Kendujhar","Khordha","Koraput","Malkangiri",

    "Mayurbhanj","Nabarangpur","Nayagarh","Nuapada","Puri",

    "Rayagada","Sambalpur","Subarnapur","Sundargarh"

  ],


  "Punjab": [

    "Amritsar","Barnala","Bathinda","Faridkot","Fatehgarh Sahib",

    "Fazilka","Ferozepur","Gurdaspur","Hoshiarpur","Jalandhar",

    "Kapurthala","Ludhiana","Malerkotla","Mansa","Moga","Mohali",

    "Muktsar","Pathankot","Patiala","Rupnagar","Sangrur",

    "Shaheed Bhagat Singh Nagar","Tarn Taran"

  ],


  "Rajasthan": [

    "Ajmer","Alwar","Banswara","Baran","Barmer","Bharatpur",

    "Bhilwara","Bikaner","Bundi","Chittorgarh","Churu","Dausa",

    "Dholpur","Dungarpur","Hanumangarh","Jaipur","Jaisalmer",

    "Jalore","Jhalawar","Jhunjhunu","Jodhpur","Karauli","Kota",

    "Nagaur","Pali","Pratapgarh","Rajsamand","Sawai Madhopur",

    "Sikar","Sirohi","Sri Ganganagar","Tonk","Udaipur"

  ],


  "Sikkim": ["East Sikkim","North Sikkim","South Sikkim","West Sikkim"],


  "Tamil Nadu": [

    "Ariyalur","Chengalpattu","Chennai","Coimbatore","Cuddalore",

    "Dharmapuri","Dindigul","Erode","Kallakurichi","Kanchipuram",

    "Kanyakumari","Karur","Krishnagiri","Madurai","Mayiladuthurai",

    "Nagapattinam","Namakkal","Nilgiris","Perambalur","Pudukkottai",

    "Ramanathapuram","Ranipet","Salem","Sivaganga","Tenkasi",

    "Thanjavur","Theni","Thoothukudi","Tiruchirappalli",

    "Tirunelveli","Tirupathur","Tiruppur","Tiruvallur",

    "Tiruvannamalai","Tiruvarur","Vellore","Viluppuram",

    "Virudhunagar"

  ],


  "Telangana": [

    "Adilabad","Bhadradri Kothagudem","Hyderabad","Jagtial",

    "Jangaon","Jayashankar Bhupalpally","Jogulamba Gadwal",

    "Kamareddy","Karimnagar","Khammam","Komaram Bheem",

    "Mahabubabad","Mahabubnagar","Mancherial","Medak",

    "Medchal Malkajgiri","Mulugu","Nagarkurnool","Nalgonda",

    "Narayanpet","Nirmal","Nizamabad","Peddapalli",

    "Rajanna Sircilla","Rangareddy","Sangareddy","Siddipet",

    "Suryapet","Vikarabad","Wanaparthy","Warangal Rural",

    "Warangal Urban","Yadadri Bhuvanagiri"

  ],


  "Tripura": [

    "Dhalai","Gomati","Khowai","North Tripura","Sepahijala",

    "South Tripura","Unakoti","West Tripura"

  ],


  "Uttar Pradesh": [

    "Agra","Aligarh","Ambedkar Nagar","Amethi","Amroha","Auraiya",

    "Ayodhya","Azamgarh","Baghpat","Bahraich","Ballia","Balrampur",

    "Banda","Barabanki","Bareilly","Basti","Bhadohi","Bijnor",

    "Budaun","Bulandshahr","Chandauli","Chitrakoot","Deoria",

    "Etah","Etawah","Farrukhabad","Fatehpur","Firozabad",

    "Gautam Buddha Nagar","Ghaziabad","Ghazipur","Gonda",

    "Gorakhpur","Hamirpur","Hapur","Hardoi","Hathras","Jalaun",

    "Jaunpur","Jhansi","Kannauj","Kanpur Dehat","Kanpur Nagar",

    "Kasganj","Kaushambi","Kheri","Kushinagar","Lalitpur",

    "Lucknow","Maharajganj","Mahoba","Mainpuri","Mathura","Mau",

    "Meerut","Mirzapur","Moradabad","Muzaffarnagar","Pilibhit",

    "Pratapgarh","Prayagraj","Raebareli","Rampur","Saharanpur",

    "Sambhal","Sant Kabir Nagar","Shahjahanpur","Shamli",

    "Shravasti","Siddharthnagar","Sitapur","Sonbhadra","Sultanpur",

    "Unnao","Varanasi"

  ],


  "Uttarakhand": [

    "Almora","Bageshwar","Chamoli","Champawat","Dehradun",

    "Haridwar","Nainital","Pauri Garhwal","Pithoragarh",

    "Rudraprayag","Tehri Garhwal","Udham Singh Nagar","Uttarkashi"

  ],


  "West Bengal": [

    "Alipurduar","Bankura","Birbhum","Cooch Behar","Dakshin Dinajpur",

    "Darjeeling","Hooghly","Howrah","Jalpaiguri","Jhargram",

    "Kalimpong","Kolkata","Malda","Murshidabad","Nadia",

    "North 24 Parganas","Paschim Bardhaman","Paschim Medinipur",

    "Purba Bardhaman","Purba Medinipur","Purulia",

    "South 24 Parganas","Uttar Dinajpur"

  ],


  // ================= UNION TERRITORIES (8) =================


  "Andaman and Nicobar Islands": [

    "Nicobar","North and Middle Andaman","South Andaman"

  ],


  "Chandigarh": ["Chandigarh"],


  "Dadra and Nagar Haveli and Daman and Diu": [

    "Dadra and Nagar Haveli","Daman","Diu"

  ],


  "Delhi": [

    "Central Delhi","East Delhi","New Delhi","North Delhi",

    "North East Delhi","North West Delhi","South Delhi",

    "South East Delhi","South West Delhi","West Delhi"

  ],


  "Jammu and Kashmir": [

    "Anantnag","Bandipora","Baramulla","Budgam","Doda","Ganderbal",

    "Jammu","Kathua","Kishtwar","Kulgam","Kupwara","Poonch",

    "Pulwama","Rajouri","Ramban","Reasi","Samba","Shopian",

    "Srinagar","Udhampur"

  ],


  "Ladakh": ["Kargil","Leh"],


  "Lakshadweep": [

    "Agatti","Amini","Andrott","Bitra","Chetlat","Kadmat",

    "Kalpeni","Kavaratti","Kilthan","Minicoy"

  ],


  "Puducherry": ["Karaikal","Mahe","Puducherry","Yanam"]

};


var selected_postid = null;
setInterval(function(){
    get_comment(selected_postid);
}, 3000);



function state(){

    var state_select = document.getElementById('state');

    for (let s in state_list){

        let option = document.createElement("option");

        option.value = s;

        option.text = s;

        state_select.append(option);

    }

}


function district() {

  var district_select = document.getElementById('district');

  district_select.innerHTML = '<option value="">---Select District---</option>';

  var state_val = document.getElementById('state').value;

  var dist = state_list[state_val];

  if(dist){
    for(let d of dist){

      let option = document.createElement("option");

      option.value = d;

      option.text = d;

      district_select.append(option);

    } 
  } 

}


function comment(){

  var com = document.getElementById('comment');
  var info = document.getElementById('information');
  var overlay = document.getElementById('overlay');

  overlay.style.display = 'block';
  info.style.display = 'block';
  com.style.display = 'block';

}


function close_comment(){

  var com = document.getElementById('comment');

  var overlay = document.getElementById('overlay');
  var info = document.getElementById('information');

  overlay.style.display = 'none';
  info.style.display = 'none';
  com.style.display = 'none';

}

function get_comment(post_id){
  fetch(`https://ayla-ropier-consuela.ngrok-free.dev/comments?post_id=${post_id}`, {
    method: "GET",
    headers: {
      "ngrok-skip-browser-warning": "true"
    }
  })
  .then(response => response.json())
  .then(data => {
    var main = document.getElementById('message');
    main.innerHTML = ''
      for(let i=0 ; i<data.length ; i++){
        var element = document.createElement('div');
        element.className = "comment_msg";
        var topic = document.createElement('h4');
        topic.textContent = data[i].comment;
        const br = document.createElement('br');

        element.append(topic);
        main.append(element);
        main.append(br);

      }
  });
}

function post_comment(){
  var input = document.getElementById('input_box');
  var msg = input.value;
  fetch("https://ayla-ropier-consuela.ngrok-free.dev/post_comment", {
    method: "POST",
    headers: {
        "Content-Type": "application/json",
        "ngrok-skip-browser-warning": "true"
    },
    body: JSON.stringify({
        post_id : selected_postid,
        msg : msg
    })
})
  .then(response => response.json())
  .then(data => {
    if(data.status == 'success'){
      input.value = "";
      console.log('comment posted');
      get_comment(selected_postid);
    }
    else{
      console.log('cannot post comment!')
    }
  });
}

function show_info(data_set){
  var info = document.getElementById('information');
  info.innerHTML = '';
  var head = document.createElement('h2');
  head.append('Approved Fund Information')
  var name = document.createElement('h4');
  name.append("Name of the Authority : " + data_set['name']);
  var designation = document.createElement('h4');
  designation.append("Designation of the Authority : " + data_set['designation']);
  var state = document.createElement('h4');
  state.append("State : " + data_set['state']);
  var district = document.createElement('h4');
  district.append("District : " + data_set['sistrict']);
  var purpose = document.createElement('h4');
  purpose.append("Purpose of the Fund : " + data_set['purpose']);
  var description = document.createElement('h4');
  description.append("Description : " + data_set['description']);
  var time = document.createElement('h4');
  time.append("Time of approval : " + data_set['time']);
  var ammount = document.createElement('h4');
  ammount.append("Approved Ammount : " + data_set['amount']);
  ammount.style.color = "green";
  const brk = document.createElement('br');


  info.append(head);
  info.append(brk);
  info.append(name);
  info.append(designation);
  info.append(state);
  info.append(district);
  info.append(purpose);
  info.append(description);
  info.append(time);
  info.append(ammount);
}


function getall() {

  fetch('https://ayla-ropier-consuela.ngrok-free.dev/all', {
    method: "GET",
    headers: {
      "ngrok-skip-browser-warning": "true"
    }
  })
  .then(response => response.json())
  .then(data => {
    console.log(data);
    var main = document.getElementById('main_box');
    main.innerHTML = '';
      for(let i=0 ; i<data.length ; i++){
        var element = document.createElement('div');
        element.className = 'fund'; 
        element.dataset.postId = data[i].post_id;
        element.dataset.name = data[i].name;
        element.dataset.purpose = data[i].purpose;
        element.dataset.designation = data[i].designation;
        element.dataset.state = data[i].state;
        element.dataset.district = data[i].district;
        element.dataset.description = data[i].description;
        element.dataset.time = data[i].time;
        element.dataset.amount = data[i].amount;
        element.addEventListener("click", function() {
                var data_set = {
                  "name":this.dataset.name,
                  "purpose":this.dataset.purpose,
                  "designation":this.dataset.designation,
                  "state":this.dataset.state,
                  "district":this.dataset.district,
                  "description":this.dataset.description,
                  "time":this.dataset.time,
                  "amount":this.dataset.amount
                }
                comment();
                selected_postid = this.dataset.postId;  // camelCase!
                get_comment(this.dataset.postId);
                show_info(data_set);
              });
        var topic = document.createElement('h4');
        topic.textContent = data[i].purpose;
        var sub_topic = document.createElement('h5');
        sub_topic.textContent = data[i].state + ' , ' + data[i].district;
        const br = document.createElement('br');

        element.append(topic);
        element.append(sub_topic);
        main.append(element);
        main.append(br);

      }
  });

}

function getstate(){
  var state = document.getElementById('state').value;
  if(state){
    fetch(`https://ayla-ropier-consuela.ngrok-free.dev/state?state=${state}`, {
      method: "GET",
      headers: {
        "ngrok-skip-browser-warning": "true"
      }
    })
    .then(response => response.json())
    .then(data => {
      var main = document.getElementById('main_box');
      main.innerHTML = ''
        for(let i=0 ; i<data.length ; i++){
          var element = document.createElement('div');
          element.className = 'fund'; 
          element.dataset.postId = data[i].post_id;
          element.dataset.name = data[i].name;
          element.dataset.purpose = data[i].purpose;
          element.dataset.designation = data[i].designation;
          element.dataset.state = data[i].state;
          element.dataset.district = data[i].district;
          element.dataset.description = data[i].description;
          element.dataset.time = data[i].time;
          element.dataset.amount = data[i].amount;
          element.addEventListener("click", function() {
              var data_set = {
                  "name":this.dataset.name,
                  "purpose":this.dataset.purpose,
                  "designation":this.dataset.designation,
                  "state":this.dataset.state,
                  "district":this.dataset.district,
                  "description":this.dataset.description,
                  "time":this.dataset.time,
                  "amount":this.dataset.amount
                }
                comment();
                selected_postid = this.dataset.postId;  // camelCase!
                console.log("Selected post ID:", selected_postid);
                get_comment(this.dataset.postId);
                show_info(data_set);
              });
          var topic = document.createElement('h4');
          topic.textContent = data[i].purpose;
          var sub_topic = document.createElement('h5');
          sub_topic.textContent = data[i].state + ' , ' + data[i].district;
          const br = document.createElement('br');

          element.append(topic);
          element.append(sub_topic);
          main.append(element);
          main.append(br);

        }
    });
  }
}

function getsort() {
  var state = document.getElementById('state').value;
  var district = document.getElementById('district').value;
  if(state && district){
    fetch(`https://ayla-ropier-consuela.ngrok-free.dev/sort?state=${state}&district=${district}`, {
      method: "GET",
      headers: {
        "ngrok-skip-browser-warning": "true"
      }
    })
    .then(response => response.json())
    .then(data => {
        var main = document.getElementById('main_box');
        main.innerHTML = '';
        for(let i=0 ; i<data.length ; i++){
          var element = document.createElement('div');
          element.className = 'fund'; 
          element.dataset.postId = data[i].post_id;
          element.dataset.name = data[i].name;
          element.dataset.purpose = data[i].purpose;
          element.dataset.designation = data[i].designation;
          element.dataset.state = data[i].state;
          element.dataset.district = data[i].district;
          element.dataset.description = data[i].description;
          element.dataset.time = data[i].time;
          element.dataset.amount = data[i].amount;
          element.addEventListener("click", function() {
                var data_set = {
                  "name":this.dataset.name,
                  "purpose":this.dataset.purpose,
                  "designation":this.dataset.designation,
                  "state":this.dataset.state,
                  "district":this.dataset.district,
                  "description":this.dataset.description,
                  "time":this.dataset.time,
                  "amount":this.dataset.amount
                }
                comment();
                selected_postid = this.dataset.postId;  // camelCase!
                console.log("Selected post ID:", selected_postid);
                get_comment(this.dataset.postId); 
                show_info(data_set);  
              });
          var topic = document.createElement('h4');
          topic.textContent = data[i].purpose;
          var sub_topic = document.createElement('h5');
          sub_topic.textContent = data[i].state + ' , ' + data[i].district;
          const br = document.createElement('br');

          element.append(topic);
          element.append(sub_topic);
          main.append(element);
          main.append(br);

        }
    });
    }

}